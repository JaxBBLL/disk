<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>disk</title>
    <link rel="stylesheet" href="./file-icons-js/css/style.css" />
    <link rel="stylesheet" href="./style.css" />
    <script src="./file-icons-js/dist/file-icons.js"></script>
    <script src="./vue.global.prod.js"></script>
  </head>
  <body>
    <div id="app" v-cloak>
      <div class="app" @contextmenu.prevent="showMenu">
        <header class="header">
          <div class="header-main">
            <div class="bread">
              <span
                v-for="(item,index) in paths"
                @click="gotoFolder(index, index===paths.length-1)"
                class="bread-item"
                :key="index"
                >{{item || '根目录'}}</span
              >
            </div>
            <span class="btn-upload" @click="handleUpload"> 上传文件 </span>
          </div>
        </header>

        <main class="main">
          <section v-if="!isLoading">
            <div class="list" v-if="list.length">
              <div
                @click="item.isDirectory ? entryDirectory(item) : handleDownload(item)"
                class="list-item"
                v-for="(item,index) in list"
                :key="index"
                @contextmenu.prevent.stop="showMenu($event, item)"
              >
                <div class="file-name">
                  <span
                    v-if="!item.isDirectory"
                    class="icon"
                    :class="item.icon"
                  ></span>
                  <svg
                    v-else
                    class="icon"
                    :class="item.icon"
                    xmlns="http://www.w3.org/2000/svg"
                    width="14"
                    height="14"
                    viewBox="0 0 512 512"
                    fill="#fee082"
                  >
                    <path
                      d="M464 128H272l-64-64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48z"
                    ></path>
                  </svg>
                  <div>{{item.name}}</div>
                </div>
                <div
                  v-if="!item.isDirectory"
                  style="margin: 0 20px; color: var(--gray-color)"
                >
                  {{item.size}} KB
                </div>
                <div style="color: var(--gray-color)">{{item.birthtime}}</div>
              </div>
            </div>
            <div class="list" v-else>
              <div style="text-align: center; padding: 10px">无文件</div>
            </div>
          </section>
          <div class="lds-roller" v-else>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>
        </main>
        <div
          v-if="isMenuVisible"
          class="menu"
          ref="menuRef"
          :style="{ top: `${menuTop}px`, left: `${menuLeft}px` }"
        >
          <ul>
            <li
              v-for="(item, index) in menuItems"
              :key="index"
              @click="handleMenuItemClick(item)"
            >
              {{ item.text }}
            </li>
          </ul>
        </div>
      </div>
    </div>
    <script type="module" src="./script.js"></script>
  </body>
</html>
